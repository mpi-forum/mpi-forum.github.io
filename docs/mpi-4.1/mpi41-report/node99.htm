<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-datatypes/datatypes-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi4-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi41-report-html.idx -basedef mpi4defs.txt -o mpi41-report.tex mpi-report.tex 
-->
<title>Subarray Datatype Constructor</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node99">6.1.3. Subarray Datatype Constructor</span></h2>
<a href="node98.htm#Node98"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node96.htm#Node96"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node100.htm#Node100"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node96.htm#Node96"> Derived Datatypes</a>
<b>Next: </b><a href="node100.htm#Node100"> Distributed Array Datatype Constructor</a>
<b>Previous: </b><a href="node98.htm#Node98"> Datatype Constructors</a>
<p>
  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_TYPE_CREATE_SUBARRAY(<span style="white-space:nowrap">ndims</span>, <span style="white-space:nowrap">array_of_sizes</span>, <span style="white-space:nowrap">array_of_subsizes</span>, <span style="white-space:nowrap">array_of_starts</span>, <span style="white-space:nowrap">order</span>, <span style="white-space:nowrap">oldtype</span>, <span style="white-space:nowrap">newtype</span>)</TD></TR>  
<TR><TD> IN ndims</TD><TD>number of array dimensions (positive integer)</TD></TR>  
<TR><TD> IN array_of_sizes</TD><TD>number of elements of type <font face="sans-serif"> oldtype</font> in each dimension of the full array (array of positive integers)</TD></TR>  
<TR><TD> IN array_of_subsizes</TD><TD>number of elements of type <font face="sans-serif"> oldtype</font> in each dimension of the subarray (array of positive integers)</TD></TR>  
<TR><TD> IN array_of_starts</TD><TD>starting coordinates of the subarray in each dimension (array of non-negative integers)</TD></TR>  
<TR><TD> IN order</TD><TD>array storage order flag (state)</TD></TR>  
<TR><TD> IN oldtype</TD><TD>old datatype (handle)</TD></TR>  
<TR><TD> OUT newtype</TD><TD>new datatype (handle)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_Type_create_subarray(int ndims, const int array_of_sizes[], const int array_of_subsizes[], const int array_of_starts[], int order, MPI_Datatype oldtype, MPI_Datatype *newtype) <br></tt>  
  
  <tt> int MPI_Type_create_subarray_c(int ndims, const MPI_Count array_of_sizes[], const MPI_Count array_of_subsizes[], const MPI_Count array_of_starts[], int order, MPI_Datatype oldtype, MPI_Datatype *newtype) <br></tt>  
  <b> Fortran 2008 binding</b><br>  <tt> MPI_Type_create_subarray(ndims, array_of_sizes, array_of_subsizes, array_of_starts, order, oldtype, newtype, ierror) <br><br>INTEGER, INTENT(IN) :: <span style="white-space:nowrap">ndims</span>, <span style="white-space:nowrap">array_of_sizes(ndims)</span>, <span style="white-space:nowrap">array_of_subsizes(ndims)</span>, <span style="white-space:nowrap">array_of_starts(ndims)</span>, <span style="white-space:nowrap">order</span> <br>TYPE(MPI_Datatype), INTENT(IN) :: <span style="white-space:nowrap">oldtype</span> <br>TYPE(MPI_Datatype), INTENT(OUT) :: <span style="white-space:nowrap">newtype</span> <br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <tt> MPI_Type_create_subarray(ndims, array_of_sizes, array_of_subsizes, array_of_starts, order, oldtype, newtype, ierror) !(_c) <br><br>INTEGER, INTENT(IN) :: <span style="white-space:nowrap">ndims</span>, <span style="white-space:nowrap">order</span> <br>INTEGER(KIND=MPI_COUNT_KIND), INTENT(IN) :: <span style="white-space:nowrap">array_of_sizes(ndims)</span>, <span style="white-space:nowrap">array_of_subsizes(ndims)</span>, <span style="white-space:nowrap">array_of_starts(ndims)</span> <br>TYPE(MPI_Datatype), INTENT(IN) :: <span style="white-space:nowrap">oldtype</span> <br>TYPE(MPI_Datatype), INTENT(OUT) :: <span style="white-space:nowrap">newtype</span> <br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <b> Fortran binding</b><br>  <tt> MPI_TYPE_CREATE_SUBARRAY(NDIMS, ARRAY_OF_SIZES, ARRAY_OF_SUBSIZES, ARRAY_OF_STARTS, ORDER, OLDTYPE, NEWTYPE, IERROR) <br><br>INTEGER <span style="white-space:nowrap">NDIMS</span>, <span style="white-space:nowrap">ARRAY_OF_SIZES(*)</span>, <span style="white-space:nowrap">ARRAY_OF_SUBSIZES(*)</span>, <span style="white-space:nowrap">ARRAY_OF_STARTS(*)</span>, <span style="white-space:nowrap">ORDER</span>, <span style="white-space:nowrap">OLDTYPE</span>, <span style="white-space:nowrap">NEWTYPE</span>, <span style="white-space:nowrap">IERROR</span> <br></tt>  
<P> 
The subarray type constructor creates an <font face="sans-serif"> MPI</font> datatype  
describing an  
<i>n</i>-dimensional  
subarray of an  
<i>n</i>-dimensional  
array.  
The subarray may be situated anywhere within the full array,  
and may be of any nonzero size up to the size of the larger array  
as long as it is confined within this array.  
This type constructor facilitates creating filetypes to access  
arrays distributed in blocks among processes to a  
single file that contains the global array,  
see <font face="sans-serif"> MPI</font> I/O, especially Section <a href="node350.htm#Node350">Definitions</a>.  
<P> 
This type constructor can handle arrays with an arbitrary number of  
dimensions and works for both C and Fortran ordered matrices  
(i.e., row-major or column-major).  Note that a C program may use Fortran  
order and a Fortran program may use C order.  
<P> 
The <font face="sans-serif"> ndims</font> parameter specifies the number of dimensions in the full  
data array and gives the number of elements in  
<font face="sans-serif"> array_of_sizes</font>, <font face="sans-serif"> array_of_subsizes</font>,  
and <font face="sans-serif"> array_of_starts</font>.  
<P> 
The number of elements of type <font face="sans-serif"> oldtype</font> in  
each dimension of the  
<i>n</i>-dimensional  
array and the  
requested subarray are specified by  
<font face="sans-serif"> array_of_sizes</font> and <font face="sans-serif"> array_of_subsizes</font>,  
respectively.  
For any dimension  
<font face="sans-serif"> i</font>,  
it is erroneous to specify  
<font face="sans-serif"> array_of_subsizes[i]</font> <i>&lt;</i> 1 or  
<font face="sans-serif"> array_of_subsizes[i]</font> <i>&gt;</i> <font face="sans-serif"> array_of_sizes[i]</font>.  
<P> 
The <font face="sans-serif"> array_of_starts</font> contains the  
starting coordinates of each  
dimension of the subarray.  
Arrays are assumed to be indexed starting from zero.  
For any dimension <i>i</i>, it is erroneous to specify  
<font face="sans-serif"> array_of_starts[i]</font> <i>&lt;</i> 0 or  
<font face="sans-serif"> array_of_starts[i]</font>  
<i>&gt;</i> (<font face="sans-serif"> array_of_sizes[i]</font> <i>-</i> <font face="sans-serif"> array_of_subsizes[i]</font>).  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
In a Fortran program with arrays indexed starting from 1,  
if the starting coordinate of a particular dimension  
of the subarray is <font face="sans-serif"> n</font>,  
then the entry in <font face="sans-serif"> array_of_starts</font>  
for that dimension is <font face="sans-serif"> n-1</font>.  
 (<em> End of advice to users.</em>) <br> 
The <font face="sans-serif"> order</font> argument specifies the storage order for the  
subarray as well as the full array.  
It must be set to one  
of the following:  
<P><img width=664 height=134 src="img116.gif" alt="Image file"><P>
A <font face="sans-serif"> ndims</font>-dimensional subarray (<font face="sans-serif"> newtype</font>) with no  
extra padding can be defined by the function Subarray() as  
follows:  
<P><img width=589 height=92 src="img117.gif" alt="Image file"><P>
Let the typemap of <font face="sans-serif"> oldtype</font> have the form:  
<img width=508 height=23 src="img118.gif" alt="Image file">
  
where <img width=42 height=19 src="img119.gif" alt="Image file">
 is a predefined <font face="sans-serif"> MPI</font> datatype, and let <i>ex</i> be the  
extent of <font face="sans-serif"> oldtype</font>.  Then we define the Subarray() function  
recursively using the following three equations.  
Equation <a href="node99.htm#Equation2">2</a> defines the base step.  
Equation <a href="node99.htm#Equation2">2</a> defines the recursion step when  
<font face="sans-serif"> order</font> = <font face="sans-serif"> MPI_ORDER_FORTRAN</font>, and  
Equation <a href="node99.htm#Equation2">2</a> defines the recursion step when  
<font face="sans-serif"> order</font> = <font face="sans-serif"> MPI_ORDER_C</font>.  
These equations use the conceptual datatypes <font face="sans-serif"> lb_marker</font>  
and <font face="sans-serif"> ub_marker</font>; see Section <a href="node102.htm#Node102">Lower-Bound and Upper-Bound Markers</a> for details.  
<P> 
<P><span id="node99.htm#Equation2"><img width=796 height=850 src="img120.gif" alt="Image file"></span><P>
For an example use of <font face="sans-serif"> MPI_TYPE_CREATE_SUBARRAY</font> in the  
context of I/O see Section <a href="node399.htm#Node399">Subarray Filetype Constructor</a>.  
<P> 

<P>
<hr>
<a href="node98.htm#Node98"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node96.htm#Node96"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node100.htm#Node100"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node96.htm#Node96"> Derived Datatypes</a>
<b>Next: </b><a href="node100.htm#Node100"> Distributed Array Datatype Constructor</a>
<b>Previous: </b><a href="node98.htm#Node98"> Datatype Constructors</a>
<p>
<HR>
Return to <A HREF="node601.htm">MPI-4.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-4.1 of November 2, 2023<BR>
HTML Generated on November 19, 2023
</FONT>
</body>
</html>
