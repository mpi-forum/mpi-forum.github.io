<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-io/io-2-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi4-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi41-report-html.idx -basedef mpi4defs.txt -o mpi41-report.tex mpi-report.tex 
-->
<title>Opening a File</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node352">15.2.1. Opening a File</span></h2>
<a href="node351.htm#Node351"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node351.htm#Node351"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node353.htm#Node353"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node351.htm#Node351"> File Manipulation</a>
<b>Next: </b><a href="node353.htm#Node353"> Closing a File</a>
<b>Previous: </b><a href="node351.htm#Node351"> File Manipulation</a>
<p>
  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_FILE_OPEN(<span style="white-space:nowrap">comm</span>, <span style="white-space:nowrap">filename</span>, <span style="white-space:nowrap">amode</span>, <span style="white-space:nowrap">info</span>, <span style="white-space:nowrap">fh</span>)</TD></TR>  
<TR><TD> IN comm</TD><TD>communicator (handle)</TD></TR>  
<TR><TD> IN filename</TD><TD>name of file to open (string)</TD></TR>  
<TR><TD> IN amode</TD><TD>file access mode (integer)</TD></TR>  
<TR><TD> IN info</TD><TD>info object (handle)</TD></TR>  
<TR><TD> OUT fh</TD><TD>new file handle (handle)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_File_open(MPI_Comm comm, const char *filename, int amode, MPI_Info info, MPI_File *fh) <br></tt>  
  <b> Fortran 2008 binding</b><br>  <tt> MPI_File_open(comm, filename, amode, info, fh, ierror) <br><br>TYPE(MPI_Comm), INTENT(IN) :: <span style="white-space:nowrap">comm</span> <br>CHARACTER(LEN=*), INTENT(IN) :: <span style="white-space:nowrap">filename</span> <br>INTEGER, INTENT(IN) :: <span style="white-space:nowrap">amode</span> <br>TYPE(MPI_Info), INTENT(IN) :: <span style="white-space:nowrap">info</span> <br>TYPE(MPI_File), INTENT(OUT) :: <span style="white-space:nowrap">fh</span> <br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <b> Fortran binding</b><br>  <tt> MPI_FILE_OPEN(COMM, FILENAME, AMODE, INFO, FH, IERROR) <br><br>INTEGER <span style="white-space:nowrap">COMM</span>, <span style="white-space:nowrap">AMODE</span>, <span style="white-space:nowrap">INFO</span>, <span style="white-space:nowrap">FH</span>, <span style="white-space:nowrap">IERROR</span> <br>CHARACTER*(*) <span style="white-space:nowrap">FILENAME</span> <br></tt>  
<P> 
<font face="sans-serif"> MPI_FILE_OPEN</font> opens the file identified by the file name  
<font face="sans-serif"> filename</font> on all processes in the <font face="sans-serif"> comm</font> communicator group.  
<font face="sans-serif"> MPI_FILE_OPEN</font> is a collective routine:  
all processes must provide the same value for <font face="sans-serif"> amode</font>,  
and all processes must provide <font face="sans-serif"> filename</font>s that  
reference the same file.  
(Values for <font face="sans-serif"> info</font> may vary.)  
<font face="sans-serif"> comm</font> must be an intra-communicator;  
it is erroneous to pass an inter-communicator to <font face="sans-serif"> MPI_FILE_OPEN</font>.  
Errors in <font face="sans-serif"> MPI_FILE_OPEN</font> are raised   
using the default file error handler  
(see Section <a href="node395.htm#Node395">I/O Error Handling</a>).  
When using the World Model (Section <a href="node265.htm#Node265">Introduction</a>),  
a process can open a file independently of other processes  
by using the <font face="sans-serif"> MPI_COMM_SELF</font> communicator.  
Applications using the Sessions Model (Section <a href="node271.htm#Node271">The Sessions Model</a>) can achieve the same result using communicators created from the <font face="sans-serif"> </font><tt>"</tt>mpi://SELF<tt>"</tt></font> process set.  
The file handle returned, <font face="sans-serif"> fh</font>,  
can be subsequently used to access the file until the file is  
closed using <font face="sans-serif"> MPI_FILE_CLOSE</font>.  
Before calling <font face="sans-serif"> MPI_FINALIZE</font>,  
the user is required to close (via <font face="sans-serif"> MPI_FILE_CLOSE</font>)  
all files that were opened with <font face="sans-serif"> MPI_FILE_OPEN</font>.  
Note that the communicator <font face="sans-serif"> comm</font> is unaffected by <font face="sans-serif"> MPI_FILE_OPEN</font>  
and continues to be usable in all <font face="sans-serif"> MPI</font> routines (e.g., <font face="sans-serif"> MPI_SEND</font>).  
Furthermore, the use of <font face="sans-serif"> comm</font> will not interfere with I/O behavior.  
<P> 
The format for specifying the file name in the <font face="sans-serif"> filename</font>  
argument is implementation dependent  
and must be documented by the implementation.  
<P> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
An implementation may require that <font face="sans-serif"> filename</font> include  
a string or strings specifying additional information about the file.  
Examples include the type of filesystem (e.g., a prefix of <tt>ufs:</tt>),  
a remote hostname (e.g., a prefix of <tt>machine.univ.edu:</tt>),  
or a file password (e.g., a suffix of <tt>/PASSWORD=SECRET</tt>).  
 (<em> End of advice to implementors.</em>) <br> 
 
<br> 
<em> Advice to users.</em>  
<P> 
On some implementations of <font face="sans-serif"> MPI</font>,  
the file namespace may not be identical from all processes of all applications.  
For example,  
``<tt>/tmp/foo</tt>'' may denote different files on different processes,  
or a single file may have many names, dependent on process location.  
The user is responsible for ensuring that a single file  
is referenced by the <font face="sans-serif"> filename</font> argument,  
as it may be impossible for an implementation to detect  
this type of namespace error.  
 (<em> End of advice to users.</em>) <br> 
Initially, all processes view the file as a linear byte stream,  
and each process views data in its own native representation  
(no data representation conversion is performed).  
(POSIX files are linear byte streams in the native representation.)  
The file view can be changed  
via the <font face="sans-serif"> MPI_FILE_SET_VIEW</font> routine.  
<P> 
The following access modes are supported  
(specified in <font face="sans-serif"> amode</font>, a bit vector <font face="sans-serif"> OR</font> of the following  
integer constants):  
<P><img width=690 height=346 src="img404.gif" alt="Image file"><P>
 
<br> 
<em> Advice to users.</em>  
<P> 
C users can use bit vector <font face="sans-serif"> OR</font> (<img width=1 height=22 src="img405.gif" alt="Image file">
) to combine these constants;  
Fortran 90 users can use the bit vector <tt>IOR</tt> intrinsic.  
Fortran 77 users can use (nonportably) bit vector <tt>IOR</tt>  
on systems that support it.  
Alternatively,  
Fortran users can portably use integer addition to <font face="sans-serif"> OR</font> the constants  
(each constant should appear at most once in the addition.).  
 (<em> End of advice to users.</em>) <br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
The values of these constants must be defined such that  
the bitwise <font face="sans-serif"> OR</font> and the sum of any distinct set  
of these constants is equivalent.  
 (<em> End of advice to implementors.</em>) <br> 
The modes <font face="sans-serif"> MPI_MODE_RDONLY</font>, <font face="sans-serif"> MPI_MODE_RDWR</font>,   
<font face="sans-serif"> MPI_MODE_WRONLY</font>,  
<font face="sans-serif"> MPI_MODE_CREATE</font>, and <font face="sans-serif"> MPI_MODE_EXCL</font> have identical semantics  
to their POSIX counterparts [<a href="node600.htm#-Bib45">45</a>].  
Exactly one of <font face="sans-serif"> MPI_MODE_RDONLY</font>, <font face="sans-serif"> MPI_MODE_RDWR</font>,   
or <font face="sans-serif"> MPI_MODE_WRONLY</font>,  
must be specified.  
It is erroneous to specify <font face="sans-serif"> MPI_MODE_CREATE</font>   
or <font face="sans-serif"> MPI_MODE_EXCL</font>  
in conjunction with <font face="sans-serif"> MPI_MODE_RDONLY</font>;  
it is erroneous to specify <font face="sans-serif"> MPI_MODE_SEQUENTIAL</font>  
together with <font face="sans-serif"> MPI_MODE_RDWR</font>.  
<P> 
The <font face="sans-serif"> MPI_MODE_DELETE_ON_CLOSE</font> mode causes the file to be deleted  
(equivalent to performing an <font face="sans-serif"> MPI_FILE_DELETE</font>)  
when the file is closed.  
<P> 
The <font face="sans-serif"> MPI_MODE_UNIQUE_OPEN</font> mode allows an implementation to  
optimize access by eliminating the overhead of file locking.  
It is erroneous to open a file in this mode unless the file will  
not be concurrently opened elsewhere.  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
For <font face="sans-serif"> MPI_MODE_UNIQUE_OPEN</font>, <em> not opened elsewhere</em> includes  
both inside and outside the <font face="sans-serif"> MPI</font> environment.  
In particular, one needs to be aware of potential external events  
that may open files (e.g., automated backup facilities).  
When <font face="sans-serif"> MPI_MODE_UNIQUE_OPEN</font> is specified,  
the user is responsible for ensuring that no such external events take place.  
 (<em> End of advice to users.</em>) <br> 
The <font face="sans-serif"> MPI_MODE_SEQUENTIAL</font> mode allows an implementation to  
optimize access to some sequential devices (tapes and network streams).  
It is erroneous to attempt nonsequential access to a  
file that has been opened in this mode.  
<P> 
Specifying <font face="sans-serif"> MPI_MODE_APPEND</font> only guarantees that all shared and individual  
file pointers are positioned at the initial end of file when <font face="sans-serif"> MPI_FILE_OPEN</font>  
returns.  
Subsequent positioning of file pointers is application dependent.  
In particular, the implementation does not ensure that all writes are  
appended.  
<P> 
Errors related to the access mode are raised  
in the class <font face="sans-serif"> MPI_ERR_AMODE</font>.  
<P> 
The <font face="sans-serif"> info</font> argument is used to provide information  
regarding file access patterns and file system specifics  
(see Section <a href="node359.htm#Node359">File Info</a>).  
The constant <font face="sans-serif"> MPI_INFO_NULL</font>  
can be used when no info needs to be specified.  
 
<br> 
<em> Advice to users.</em>  
<P> 
Some file attributes are inherently implementation dependent  
(e.g., file permissions).  
These attributes must be set using either  
the <font face="sans-serif"> info</font> argument or facilities outside the scope of <font face="sans-serif"> MPI</font>.  
 (<em> End of advice to users.</em>) <br> 
Files are opened by default using nonatomic mode file consistency semantics  
(see Section <a href="node383.htm#Node383">File Consistency</a>).  
The more stringent atomic mode consistency semantics,  
required for atomicity of conflicting accesses,  
can be set using <font face="sans-serif"> MPI_FILE_SET_ATOMICITY</font>.  
<P> 

<P>
<hr>
<a href="node351.htm#Node351"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node351.htm#Node351"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node353.htm#Node353"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node351.htm#Node351"> File Manipulation</a>
<b>Next: </b><a href="node353.htm#Node353"> Closing a File</a>
<b>Previous: </b><a href="node351.htm#Node351"> File Manipulation</a>
<p>
<HR>
Return to <A HREF="node601.htm">MPI-4.1 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-4.1 of November 2, 2023<BR>
HTML Generated on November 19, 2023
</FONT>
</body>
</html>
